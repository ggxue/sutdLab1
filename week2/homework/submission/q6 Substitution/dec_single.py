import collections
import binascii

# Define the frequency distribution of letters in the English language
english_frequencies = {
    'e': 12.02, 't': 9.10, 'a': 8.12, 'o': 7.68, 'i': 7.31, 'n': 6.95, 's': 6.28, 'r': 6.02,
    'h': 5.92, 'd': 4.32, 'l': 3.98, 'u': 2.88, 'c': 2.71, 'm': 2.61, 'f': 2.30, 'y': 2.11,
    'w': 2.09, 'g': 2.03, 'p': 1.82, 'b': 1.49, 'v': 1.11, 'k': 0.69, 'x': 0.17, 'q': 0.11,
    'j': 0.10, 'z': 0.07
}


# Function to calculate the frequency distribution of letters in a given text
def calculate_frequencies(text):
    counter = collections.Counter(text)
    total = len(text)
    frequencies = {letter: (count / total) * 100 for letter, count in counter.items()}
    return frequencies

# Hex string to be deciphered
hex_string = "fb098b8bfbdb9e67db45aaf59a18a73725f5db9ec41837259e9a9e8b0949db9e8b4fdb67db9ebd9a529e9a9e45db9a679efb098b8bfbdb9e5f0967fb9ebd4f379ebd9a529efb3784db45a7cdff9edb84db67ff9e3725db9ebd4f379efb3737bcdb459e9a8b9e4fdb67949ecdc48b9e4937528b9e37069e9afbfb9ecdff9e4fdb67a75f679a254549378b4fdb67949e9a25459e8b4fdb67db9ebd9a529e25378b4f09255f9e8b4f9a8b9e524fdb9ebd37c4fb459e25378b9e4f9a84dba75f0984db259e8b379e8b4fdb9ef54f09fb455b9e9e3725f5db9e524fdb9e5f9a84db9e4fdb679e9a9efb098b8bfbdb9ef59a189e37069e67db45a784dbfb84db8b949ebd4f09f54f9e52c4098bdb459e4fdb679e52379ebddbfbfb9e8b4f9a8b9e524fdb9ebd37c4fb459e25db84db679ebddb9a67a79a25ff8b4f09255f9edbfb52db5b9e9e52379e524fdb9ebd9a529e9afbbd9aff529ef59afbfbdb459efb098b8bfbdb9e67db45aaf59a185ba73725db9e459aff9e4fdb679e49378b4fdb679e529a09459e8b379e4fdb67949ef53749db949efb098b8bfbdb9e67db45aaf59a18949e4fdb67dba709529e9a9e1809dbf5db9e37069ef59abcdb9e9a25459e9a9ecd378b8bfbdb9e37069ebd0925db5b9e9e8b9abcdb9e8b4fdb499e8b379eff37c467a75f679a254549378b4fdb67949e524fdb9e09529e09fbfb9e9a25459ebddb9abc949e9a25459e8b4fdbff9ebd09fbfb9e45379e4fdb679e5f3737455ba752db8b9e37c48b9ecddb063767db9e098b9e5fdb8b529e4f378b949e9a25459ebd4fdb259eff37c49e9a67db9e5f3709255f949ebd9afbbca72509f5dbfbff9e9a25459e81c409db8bfbff9e9a25459e45379e25378b9e67c4259e3706069e8b4fdb9e189a8b4f949e37679eff37c49e499affa7069afbfb9e9a25459ecd67db9abc9e8b4fdb9ecd378b8bfbdb949e9a25459e8b4fdb259eff37c4679e5f679a254549378b4fdb679ebd09fbfba75fdb8b9e25378b4f09255f5b9e9e9a25459ebd4fdb259eff37c49e5f379e09258b379e4fdb679e67373749949e4537250b8b9e0637675fdb8ba78b379e529aff949e5f373745aa4937672509255f949e9a25459e4537250b8b9e18dbdb189e09258b379edb84db67ff9ef5376725db679ecddb063767dba7ff37c49e45379e098b5ba7099ebd09fbfb9e8b9abcdb9e5f67db9a8b9ef59a67db949e529a09459efb098b8bfbdb9e67db45aaf59a189e8b379e4fdb679e49378b4fdb67949e9a2545a75f9a84db9e4fdb679e4f9a25459e37259e098b5ba78b4fdb9e5f679a254549378b4fdb679efb0984db459e37c48b9e09259e8b4fdb9ebd373745949e4f9afb069e9a9efbdb9a5fc4db9e066737499e8b4fdba78409fbfb9a5fdb949e9a25459e7dc4528b9e9a529efb098b8bfbdb9e67db45aaf59a189edb258bdb67db459e8b4fdb9ebd373745949e9a9ebd37fb06a749db8b9e4fdb675b9e9e67db45aaf59a189e4509459e25378b9ebc2537bd9ebd4f9a8b9e9a9ebd09f5bcdb459ef567db9a8bc467db9e4fdb9ebd9a5294a79a25459ebd9a529e25378b9e9a8b9e9afbfb9e9a06679a09459e37069e4f09495ba75f373745aa459aff949efb098b8bfbdb9e67db45aaf59a18949e529a09459e4fdb5ba78b4f9a25bc9eff37c49ebc092545fbff949ebd37fb065ba7bd4f098b4fdb679e9abd9aff9e52379edb9a67fbff949efb098b8bfbdb9e67db45aaf59a18eda78b379e49ff9e5f679a254549378b4fdb670b525ba7bd4f9a8b9e4f9a84db9eff37c49e5f378b9e09259eff37c4679e9a18673725eda7f59abcdb9e9a25459ebd0925db5b9e9effdb528bdb67459aff9ebd9a529ecd9abc09255faa459aff949e52379e183737679e5209f5bca75f679a254549378b4fdb679e09529e8b379e4f9a84db9e523749db8b4f09255f9e5f373745949e8b379e499abcdb9e4fdb679e528b6737255fdb675ba7bd4fdb67db9e4537db529eff37c4679e5f679a254549378b4fdb679efb0984db949efb098b8bfbdb9e67db45aaf59a18eda79a9e5f3737459e81c49a678bdb679e37069e9a9efbdb9a5fc4db9e069a678b4fdb679e37259e09259e8b4fdb9ebd3737455b9e9e4fdb679e4f37c452dba7528b9a2545529ec42545db679e8b4fdb9e8b4f67dbdb9efb9a675fdb9e379abcaa8b67dbdb52949e8b4fdb9e25c48baa8b67dbdb529e9a67db9e7dc4528ba7cddbfb37bd5b9e9eff37c49e52c467dbfbff9e49c4528b9ebc2537bd9e098b949e67db18fb09db459efb098b8bfbdb9e67db45aaf59a185ba78b4fdb9ebd37fb069e8b4f37c45f4f8b9e8b379e4f094952dbfb06949ebd4f9a8b9e9a9e8bdb2545db679eff37c4255f9ef567db9a8bc467db5b9e9ebd4f9a8b9e9aa72509f5db9e18fbc449189e4937c48b4f06c4fb949e524fdb9ebd09fbfb9ecddb9ecddb8b8bdb679e8b379edb9a8b9e8b4f9a259e8b4fdb9e37fb45a7bd37499a255b9e9e099e49c4528b9e9af58b9ef5679a068b09fbff949e52379e9a529e8b379ef59a8bf54f9ecd378b4f5b9e9e52379e4fdb9ebd9afbbcdb45a70637679e9a9e524f37678b9e8b0949db9ecdff9e8b4fdb9e520945db9e37069efb098b8bfbdb9e67db45aaf59a18949e9a25459e8b4fdb259e4fdba7529a0945949e52dbdb9efb098b8bfbdb9e67db45aaf59a18949e4f37bd9e1867db8b8bff9e8b4fdb9e06fb37bddb67529e9a67db9e9acd37c48b9e4fdb67db5ba7bd4fff9e45379eff37c49e25378b9efb3737bc9e6737c425455b9e9e099ecddbfb09db84db949e8b3737949e8b4f9a8b9eff37c49e45379e25378ba74fdb9a679e4f37bd9e52bddbdb8bfbff9e8b4fdb9efb098b8bfbdb9ecd096745529e9a67db9e5209255f09255f5b9e9eff37c49ebd9afbbc9e5f679a84dbfbffa79afb37255f9e9a529e09069eff37c49ebddb67db9e5f3709255f9e8b379e52f54f3737fb949ebd4f09fbdb9edb84db67ff8b4f09255f9edbfb52db9e37c48ba74fdb67db9e09259e8b4fdb9ebd3737459e09529e49db6767ff5ba7fb098b8bfbdb9e67db45aaf59a189e679a0952db459e4fdb679edbffdb52949e9a25459ebd4fdb259e524fdb9e529abd9e8b4fdb9e52c425cddb9a4952a7459a25f509255f9e4fdb67db9e9a25459e8b4fdb67db9e8b4f6737c45f4f9e8b4fdb9e8b67dbdb52949e9a25459e1867db8b8bff9e06fb37bddb6752a75f6737bd09255f9edb84db67ffbd4fdb67db949e524fdb9e8b4f37c45f4f8b949e52c418183752db9e099e8b9abcdb9e5f679a254549378b4fdb679e9aa70667db524f9e253752db5f9aff5b9e9e8b4f9a8b9ebd37c4fb459e18fbdb9a52db9e4fdb679e8b37375b9e9e098b9e09529e52379edb9a67fbff9e09259e8b4fdba7459aff9e8b4f9a8b9e099e524f9afbfb9e528b09fbfb9e5fdb8b9e8b4fdb67db9e09259e5f3737459e8b0949db5b9e9e9a25459e52379e524fdb9e679a25a7066737499e8b4fdb9e189a8b4f9e09258b379e8b4fdb9ebd3737459e8b379efb3737bc9e0637679e06fb37bddb67525b9e9e9a25459ebd4fdb25db84db67a7524fdb9e4f9a459e1809f5bcdb459e3725db949e524fdb9e069a25f509db459e8b4f9a8b9e524fdb9e529abd9e9a9e528b09fbfb9e1867db8b8b09db679e3725dba7069a678b4fdb679e3725949e9a25459e679a259e9a068bdb679e098b949e9a25459e52379e5f378b9e45dbdb18db679e9a25459e45dbdb18db679e09258b37a78b4fdb9ebd3737455ba749db9a25bd4f09fbdb9e8b4fdb9ebd37fb069e679a259e528b679a095f4f8b9e8b379e8b4fdb9e5f679a254549378b4fdb670b529e4f37c452db9e9a2545a7bc2537f5bcdb459e9a8b9e8b4fdb9e453737675ba7bd4f379e09529e8b4fdb67dbeda7fb098b8bfbdb9e67db45aaf59a18949e67db18fb09db459e8b4fdb9ebd37fb065b9e9e524fdb9e09529ecd6709255f09255f9ef59abcdb9e9a2545a7bd0925db5b9e9e3718db259e8b4fdb9e453737675ba7fb09068b9e8b4fdb9efb9a8bf54f949ef59afbfbdb459e37c48b9e8b4fdb9e5f679a254549378b4fdb67949e099e9a499e8b37379ebddb9abc949e9a2545a7f59a2525378b9e5fdb8b9ec4185ba78b4fdb9ebd37fb069efb09068bdb459e8b4fdb9efb9a8bf54f949e8b4fdb9e453737679e5218679a255f9e3718db25949e9a25459ebd098b4f37c48ba7529aff09255f9e9a9ebd3767459e4fdb9ebddb258b9e528b679a095f4f8b9e8b379e8b4fdb9e5f679a254549378b4fdb670b529ecddb45949e9a2545a745db8437c467db459e4fdb675b9e9e8b4fdb259e4fdb9e18c48b9e37259e4fdb679ef5fb378b4fdb52949e4567db5252db459e4f094952dbfb069e0925a74fdb679ef59a18949efb9a09459e4f094952dbfb069e09259ecddb459e9a25459e4567dbbd9e8b4fdb9ef5c4678b9a0925525ba7fb098b8bfbdb9e67db45aaf59a18949e4f37bddb84db67949e4f9a459ecddbdb259e67c4252509255f9e9acd37c48b9e1809f5bc09255f9e06fb37bddb675294a79a25459ebd4fdb259e524fdb9e4f9a459e5f9a8b4fdb67db459e52379e499a25ff9e8b4f9a8b9e524fdb9ef537c4fb459ef59a6767ffa725379e493767db949e524fdb9e67db49db49cddb67db459e4fdb679e5f679a254549378b4fdb67949e9a25459e52db8b9e37c48b9e37259e8b4fdba7bd9aff9e8b379e4fdb675ba7524fdb9ebd9a529e52c46718670952db459e8b379e060925459e8b4fdb9ef5378b8b9a5fdbaa453737679e528b9a254509255f9e3718db25949e9a2545a7bd4fdb259e524fdb9ebddb258b9e09258b379e8b4fdb9e67373749949e524fdb9e4f9a459e52c4f54f9e9a9e528b679a255fdb9e06dbdbfb09255f9e8b4f9a8ba7524fdb9e529a09459e8b379e4fdb6752dbfb06949e374f9e45db9a67949e4f37bd9ec425db9a52ff9e099e06dbdbfb9e8b37aa459aff949e9a25459e9a8ba7378b4fdb679e8b0949db529e099efb09bcdb9ecddb09255f9ebd098b4f9e5f679a254549378b4fdb679e52379e49c4f54f5b9e9e524fdb9ef59afbfbdb45a737c48b949e5f3737459e4937672509255f949ecdc48b9e67dbf5db0984db459e25379e9a2552bddb675b9e9e52379e524fdb9ebddb258b9e8b379e8b4fdba7cddb459e9a25459e4567dbbd9ecd9af5bc9e8b4fdb9ef5c4678b9a0925525b9e9e8b4fdb67db9efb9aff9e4fdb679e5f679a254549378b4fdb679ebd098b4fa74fdb679ef59a189e18c4fbfbdb459e069a679e3784db679e4fdb679e069af5db949e9a25459efb3737bc09255f9e84db67ff9e528b679a255fdb5ba7374f949e5f679a254549378b4fdb67949e524fdb9e529a0945949ebd4f9a8b9ecd095f9edb9a67529eff37c49e4f9a84db5ba78b4fdb9ecddb8b8bdb679e8b379e4fdb9a679eff37c49ebd098b4f949e49ff9ef54f09fb45949ebd9a529e8b4fdb9e67db18fbff5ba7cdc48b949e5f679a254549378b4fdb67949ebd4f9a8b9ecd095f9edbffdb529eff37c49e4f9a84db949e524fdb9e529a09455ba78b4fdb9ecddb8b8bdb679e8b379e52dbdb9eff37c49ebd098b4f949e49ff9e45db9a675ba7cdc48b949e5f679a254549378b4fdb67949ebd4f9a8b9efb9a675fdb9e4f9a2545529eff37c49e4f9a84db5ba78b4fdb9ecddb8b8bdb679e8b379e4fc45f9eff37c49ebd098b4f5ba7374f949ecdc48b949e5f679a254549378b4fdb67949ebd4f9a8b9e9a9e8bdb676709cdfbdb9ecd095f9e4937c48b4f9eff37c49e4f9a84db5ba78b4fdb9ecddb8b8bdb679e8b379edb9a8b9eff37c49ebd098b4f5ba79a25459e52f59a67f5dbfbff9e4f9a459e8b4fdb9ebd37fb069e529a09459e8b4f0952949e8b4f9a259ebd098b4f9e3725db9ecd37c425459e4fdb9ebd9a52a737c48b9e37069ecddb459e9a25459e52bd9afbfb37bddb459ec4189e67db45aaf59a185ba7bd4fdb259e8b4fdb9ebd37fb069e4f9a459e9a1818db9a52db459e4f09529e9a1818db8b098bdb949e4fdb9efb9aff9e4537bd259e9a5f9a09259e0925a78b4fdb9ecddb45949e06dbfbfb9e9a52fbdbdb189e9a25459ecddb5f9a259e8b379e52253767db9e84db67ff9efb37c4455b9e9e8b4fdba74fc4258b52499a259ebd9a529e7dc4528b9e189a525209255f9e8b4fdb9e4f37c452db949e9a25459e8b4f37c45f4f8b9e8b379e4f094952dbfb06949e4f37bda78b4fdb9e37fb459ebd37499a259e09529e5225376709255f5b9e9e099e49c4528b9e7dc4528b9e52dbdb9e09069e524fdb9ebd9a258b529e9a25ff8b4f09255f5ba752379e4fdb9ebddb258b9e09258b379e8b4fdb9e67373749949e9a25459ebd4fdb259e4fdb9ef59a49db9e8b379e8b4fdb9ecddb45949e4fdb9e529abda78b4f9a8b9e8b4fdb9ebd37fb069ebd9a529efbff09255f9e09259e098b5b9e9e45379e099e060925459eff37c49e4fdb67db949eff37c49e37fb45a752092525db67949e529a09459e4fdb5b9e9e099e4f9a84db9efb37255f9e5237c45f4f8b9eff37c45b9e9e8b4fdb259e7dc4528b9e9a529e4fdb9ebd9a529e5f3709255fa78b379e060967db9e9a8b9e4f0949949e098b9e37f5f5c46767db459e8b379e4f09499e8b4f9a8b9e8b4fdb9ebd37fb069e49095f4f8b9e4f9a84dba745db8437c467db459e8b4fdb9e5f679a254549378b4fdb67949e9a25459e8b4f9a8b9e524fdb9e49095f4f8b9e528b09fbfb9ecddb9e529a84db45949e5237a74fdb9e4509459e25378b9e060967db949ecdc48b9e8b3737bc9e9a9e189a09679e37069e52f5095252376752949e9a25459ecddb5f9a259e8b379ef5c48ba73718db259e8b4fdb9e528b37499af54f9e37069e8b4fdb9e52fbdbdb1809255f9ebd37fb065b9e9ebd4fdb259e4fdb9e4f9a459e499a45db9e8bbd37a75225091852949e4fdb9e529abd9e8b4fdb9efb098b8bfbdb9e67db45aaf59a"  # Replace with the actual hex string

# Convert hex string to ASCII
a = hex_string[2:]
byte_string = binascii.unhexlify(a)
try:
    plain_text = byte_string.decode('utf-8')
except UnicodeDecodeError:
    # Fallback to Latin-1 encoding
    plain_text = byte_string.decode('latin-1')

# Convert byte string to plain text
# plain_text = byte_string.decode()

# Calculate letter frequencies in the ciphered text
ciphered_frequencies = calculate_frequencies(plain_text.lower())

# Sort the ciphered frequencies dictionary by values in descending order
sorted_ciphered_frequencies = {
    k: v for k, v in sorted(ciphered_frequencies.items(), key=lambda item: item[1], reverse=True)
}

# Match the most frequent letters in the ciphered text with the corresponding English letter frequencies
mapping = {}
for ciphered_letter, ciphered_frequency in sorted_ciphered_frequencies.items():
    english_letter = max(english_frequencies, key=lambda x: english_frequencies[x])
    mapping[ciphered_letter] = english_letter
    del english_frequencies[english_letter]

# Decrypt the ciphered text using the mapping
deciphered_text = ''.join(mapping.get(letter, letter) for letter in ascii_text)

# Print the deciphered text
print(deciphered_text)
